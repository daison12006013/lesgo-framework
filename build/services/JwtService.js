"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _jsonwebtoken=_interopRequireDefault(require("jsonwebtoken")),_LesgoException=_interopRequireDefault(require("../exceptions/LesgoException"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}class JwtService{constructor(a,b,c){this.decoded=_jsonwebtoken.default.verify(a,b),this.settings=c}validate(){if(this.settings.validate.iss&&-1===this.settings.config.iss.indexOf(this.decoded.iss))throw new _LesgoException.default(`Token's [iss] is not valid!`);return this.settings.config.customClaims.forEach(a=>{if(this.settings.validate.customClaims&&!this.decoded[a])throw new _LesgoException.default(`Token's custom claim [${a}] not found!`)}),this}static jwt(){return _jsonwebtoken.default}}exports.default=JwtService;